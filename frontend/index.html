<!DOCTYPE html>
<html lang="pt-BR">
   
  <head>
       
    <meta charset="UTF-8" />
       
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
       
    <title>Treinador Pro - Dashboard</title>
           
    <link rel="stylesheet" href="/css/main.css" />

     
    <link rel="icon" type="image/png" href="/frontend/imagem/jjj.jpg" />
  </head>
   
  <body>
       
    <header>
           
      <h1>Treinador Pro</h1>
           
      <nav>
                <a href="index.html">Dashboard</a>        
        <a href="cadastro.html">Novo Aluno</a>      
      </nav>
         
    </header>
       
    <main>
           
      <div class="card">
               
        <h2>Lista de Alunos</h2>
               
        <table id="tabela-alunos">
                   
          <thead>
                       
            <tr>
                           
              <th>Nome</th>
                           
              <th>Email</th>
                           
              <th>Ação</th>
                         
            </tr>
                     
          </thead>
                   
          <tbody></tbody>
                 
        </table>
             
      </div>
         
    </main>

       
    <script>
      // URL do backend no Render (Usando a URL fixa que você forneceu)
      const API_URL = "https://app-jorlan.onrender.com/api/alunos";

      async function listarAlunos() {
        const tbody = document
          .getElementById("tabela-alunos")
          .querySelector("tbody");
        tbody.innerHTML = '<tr><td colspan="3">Carregando...</td></tr>';
        try {
          const response = await fetch(API_URL);
          // Verifica se a resposta foi bem-sucedida (status 200-299)
          if (!response.ok) {
            throw new Error(`Falha ao buscar dados: ${response.status}`);
          }

          const alunos = await response.json();
          tbody.innerHTML = "";
          if (!alunos || alunos.length === 0) {
            tbody.innerHTML =
              '<tr><td colspan="3">Nenhum aluno cadastrado.</td></tr>';
            return;
          }

          alunos.forEach((aluno) => {
            const tr = document.createElement("tr");
            tr.innerHTML = `
              <td>${aluno.nome}</td>
              <td>${aluno.email || "-"}</td>
              <td>
                <a href="aluno.html?id=${aluno.id}" class="btn-acao">
                  Acompanhar / Planilha
                </a>
              </td>
            `;
            tbody.appendChild(tr);
          });
        } catch (error) {
          tbody.innerHTML =
            '<tr><td colspan="3">Erro ao carregar alunos. Verifique a URL da API ou o status do Backend.</td></tr>';
        }
      }

      listarAlunos();
    </script>
     
  </body>
</html>
